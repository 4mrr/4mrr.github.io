<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploiting AD Trust Relationships ‚Äî 4mr Blog</title>
    <meta name="description" content="A deep dive into abusing trust relationships between Active Directory forests for lateral movement.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Syne:wght@400;500;600;700;800&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #06060b;
            --bg2: #0c0c14;
            --card: #111119;
            --accent: #00ffaa;
            --accent8: rgba(0,255,170,0.08);
            --accent15: rgba(0,255,170,0.15);
            --red: #ff2d55;
            --orange: #ff8c00;
            --blue: #00aaff;
            --yellow: #ffd60a;
            --txt: #e4e4ee;
            --dim: #6e6e82;
            --mid: #9e9eb2;
            --bdr: #1e1e2e;
            --bdr2: #2a2a3e;
            --mono: 'JetBrains Mono', monospace;
            --head: 'Syne', sans-serif;
            --body: 'Outfit', sans-serif;
        }
        *{margin:0;padding:0;box-sizing:border-box}
        ::selection{background:var(--accent);color:var(--bg)}
        html{scroll-behavior:smooth;scrollbar-width:thin;scrollbar-color:var(--accent) var(--bg)}
        body{background:var(--bg);color:var(--txt);font-family:var(--body);overflow-x:hidden;line-height:1.7}

        body::before{content:'';position:fixed;inset:0;background:url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E");pointer-events:none;z-index:9999}
        .grid-bg{position:fixed;inset:0;background-image:linear-gradient(rgba(30,30,46,0.4) 1px,transparent 1px),linear-gradient(90deg,rgba(30,30,46,0.4) 1px,transparent 1px);background-size:80px 80px;opacity:.06;z-index:-1}

        /* NAV */
        nav{position:fixed;top:0;left:0;right:0;z-index:1000;padding:1rem 2.5rem;display:flex;justify-content:space-between;align-items:center;backdrop-filter:blur(20px);background:rgba(6,6,11,.88);border-bottom:1px solid var(--bdr)}
        .logo{font-family:var(--mono);font-weight:700;font-size:1.3rem;color:var(--accent);text-decoration:none;letter-spacing:-.5px}
        .logo .d{color:var(--dim);font-weight:400}
        .nav-l{display:flex;gap:2rem;list-style:none}
        .nav-l a{font-family:var(--mono);font-size:.72rem;color:var(--dim);text-decoration:none;text-transform:uppercase;letter-spacing:2px;transition:color .3s}
        .nav-l a:hover{color:var(--accent)}

        /* ARTICLE */
        .article{max-width:800px;margin:0 auto;padding:8rem 2.5rem 5rem}

        .article-back{font-family:var(--mono);font-size:.75rem;color:var(--accent);text-decoration:none;letter-spacing:1px;display:inline-block;margin-bottom:2rem;transition:transform .3s}
        .article-back:hover{transform:translateX(-5px)}

        .article-meta{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}
        .article-date{font-family:var(--mono);font-size:.72rem;color:var(--accent);letter-spacing:1px}
        .article-tag{font-family:var(--mono);font-size:.6rem;padding:.25rem .6rem;background:var(--accent8);color:var(--accent);text-transform:uppercase;letter-spacing:1px}
        .article-tag.red{background:rgba(255,45,85,.1);color:var(--red)}

        .article h1{font-family:var(--head);font-size:clamp(2rem,4vw,2.8rem);font-weight:800;letter-spacing:-1.5px;margin-bottom:1rem;line-height:1.2}

        .article-author{display:flex;align-items:center;gap:.8rem;padding:1.5rem 0;border-top:1px solid var(--bdr);border-bottom:1px solid var(--bdr);margin-bottom:3rem}
        .author-avatar{width:40px;height:40px;border-radius:50%;background:var(--accent);display:flex;align-items:center;justify-content:center;font-family:var(--mono);font-weight:700;color:var(--bg);font-size:.9rem}
        .author-name{font-weight:600;font-size:.9rem}
        .author-handle{font-family:var(--mono);font-size:.72rem;color:var(--dim)}

        /* CONTENT */
        .content{color:var(--mid);font-size:1.05rem;line-height:2}
        .content p{margin-bottom:1.5rem}
        .content h2{font-family:var(--head);font-size:1.6rem;font-weight:700;color:var(--txt);margin:3rem 0 1.2rem;letter-spacing:-.5px}
        .content h3{font-family:var(--head);font-size:1.2rem;font-weight:600;color:var(--txt);margin:2rem 0 1rem}
        .content strong{color:var(--txt);font-weight:600}
        .content a{color:var(--accent);text-decoration:none;border-bottom:1px solid var(--accent8);transition:border-color .3s}
        .content a:hover{border-color:var(--accent)}

        .content code{font-family:var(--mono);font-size:.88rem;background:var(--card);color:var(--accent);padding:2px 8px;border-radius:3px}
        .content pre{background:var(--card);border:1px solid var(--bdr);padding:1.5rem;margin:1.5rem 0;overflow-x:auto;border-radius:4px;position:relative}
        .content pre code{background:none;padding:0;color:var(--txt);font-size:.82rem;line-height:1.8}
        .content pre::before{content:attr(data-lang);position:absolute;top:.6rem;right:.8rem;font-family:var(--mono);font-size:.6rem;color:var(--dim);text-transform:uppercase;letter-spacing:1px}

        .content blockquote{border-left:3px solid var(--accent);background:var(--card);padding:1.2rem 1.5rem;margin:1.5rem 0;color:var(--dim);font-style:italic}

        .content ul,.content ol{margin:1rem 0 1.5rem 1.5rem;color:var(--mid)}
        .content li{margin-bottom:.5rem}
        .content li::marker{color:var(--accent)}

        .content img{max-width:100%;border:1px solid var(--bdr);margin:1.5rem 0;border-radius:4px}

        .content .note{background:var(--accent8);border:1px solid rgba(0,255,170,.2);padding:1.2rem 1.5rem;margin:1.5rem 0;border-radius:4px;font-size:.92rem}
        .content .note::before{content:'üí° ';font-size:1rem}

        .content .warning{background:rgba(255,45,85,.08);border:1px solid rgba(255,45,85,.2);padding:1.2rem 1.5rem;margin:1.5rem 0;border-radius:4px;font-size:.92rem;color:var(--red)}
        .content .warning::before{content:'‚ö†Ô∏è ';font-size:1rem}

        /* TABLE OF CONTENTS */
        .toc{background:var(--card);border:1px solid var(--bdr);padding:1.5rem 2rem;margin-bottom:3rem;border-radius:4px}
        .toc-title{font-family:var(--mono);font-size:.72rem;color:var(--accent);text-transform:uppercase;letter-spacing:2px;margin-bottom:1rem}
        .toc ul{list-style:none;padding:0}
        .toc li{margin-bottom:.5rem}
        .toc a{font-size:.9rem;color:var(--dim);text-decoration:none;transition:color .3s;font-family:var(--body)}
        .toc a:hover{color:var(--accent)}
        .toc a::before{content:'‚Üí ';color:var(--accent);opacity:.4}

        /* POST NAV */
        .post-nav{display:flex;justify-content:space-between;margin-top:4rem;padding-top:2rem;border-top:1px solid var(--bdr);gap:1rem}
        .post-nav a{font-family:var(--mono);font-size:.75rem;color:var(--dim);text-decoration:none;transition:color .3s;letter-spacing:1px}
        .post-nav a:hover{color:var(--accent)}

        /* FOOTER */
        footer{text-align:center;padding:3rem 2.5rem;border-top:1px solid var(--bdr);font-family:var(--mono);font-size:.72rem;color:var(--dim)}
        footer .a{color:var(--accent)}

        @media(max-width:768px){
            .article{padding:6rem 1.5rem 4rem}
            nav{padding:1rem 1.5rem}
        }
    </style>
</head>
<body>

<div class="grid-bg"></div>

<!-- NAV -->
<nav>
    <a href="/" class="logo">4mr<span class="d">@blog</span></a>
    <ul class="nav-l">
        <li><a href="/">Portfolio</a></li>
        <li><a href="/blog/">Blog</a></li>
    </ul>
</nav>

<!-- ARTICLE -->
<article class="article">
    <a href="/blog/" class="article-back">‚Üê Back to posts</a>

    <div class="article-meta">
        <span class="article-date">12 Feb 2026</span>
        <span class="article-tag">Active Directory</span>
        <span class="article-tag red">Red Team</span>
    </div>

    <h1>Exploiting Active Directory Trust Relationships Across Forests</h1>

    <div class="article-author">
        <div class="author-avatar">4m</div>
        <div>
            <div class="author-name">Amr En-Niari</div>
            <div class="author-handle">@4mrr ¬∑ 8 min read</div>
        </div>
    </div>

    <!-- TABLE OF CONTENTS -->
    <div class="toc">
        <div class="toc-title">Table of Contents</div>
        <ul>
            <li><a href="#intro">Introduction</a></li>
            <li><a href="#trust-types">Understanding Trust Types</a></li>
            <li><a href="#enumeration">Enumerating Trust Relationships</a></li>
            <li><a href="#exploitation">Exploitation Techniques</a></li>
            <li><a href="#detection">Detection & Mitigation</a></li>
        </ul>
    </div>

  
    <div class="content">
        <h2 id="intro">Introduction</h2>
        <p>
            Active Directory trust relationships are a powerful feature that enables resource sharing
            between domains and forests. However, when misconfigured, they become a significant attack
            vector for lateral movement and privilege escalation. In this post, we'll explore how to
            identify and exploit these relationships during red team engagements.
        </p>

        <div class="note">
            This post is based on real-world engagements and lab environments.
        </div>

        <h2 id="trust-types">Understanding Trust Types</h2>
        <p>
            Before diving into exploitation, it's important to understand the different types of trusts
            that exist in Active Directory environments.
        </p>

        <h3>Parent-Child Trusts</h3>
        <p>
            These are <strong>automatically created</strong> when a new child domain is added to an existing
            domain tree. They are always two-way transitive trusts.
        </p>

        <pre data-lang="powershell"><code># Enumerate trusts using PowerView
Get-DomainTrust
Get-DomainTrust -Domain child.corp.local

# Using AD Module
Get-ADTrust -Filter *
Get-ADTrust -Identity "child.corp.local"</code></pre>

        <h2 id="enumeration">Enumerating Trust Relationships</h2>
        <p>
            The first step is always enumeration. We need to identify what trusts exist, their direction,
            and whether SID filtering is enabled.
        </p>

        <pre data-lang="powershell"><code># BloodHound collection
SharpHound.exe -c All,GPOLocalGroup --domain corp.local

# Map all trusts in the forest
Get-DomainTrustMapping

# Check SID filtering status
Get-DomainTrust | Select-Object SourceName,TargetName,TrustAttributes</code></pre>

        <div class="warning">
            Always verify your scope and authorization before performing trust enumeration in production environments.
        </div>

        <h2 id="exploitation">Exploitation Techniques</h2>
        <p>
            Once we've mapped the trust relationships, several attack paths become available depending on
            the trust configuration.
        </p>

        <h3>Cross-Forest Kerberoasting</h3>
        <p>
            If a two-way trust exists between forests, we can request service tickets for SPNs in the
            target forest and attempt to crack them offline.
        </p>

        <pre data-lang="powershell"><code># Kerberoast across trust
Rubeus.exe kerberoast /domain:target.local /dc:dc01.target.local

# Using PowerView
Get-DomainUser -SPN -Domain target.local | Get-DomainSPNTicket</code></pre>

        <h2 id="detection">Detection & Mitigation</h2>
        <p>
            As security consultants, we should always provide remediation recommendations. Key mitigations
            for trust abuse include enabling <strong>SID filtering</strong>, implementing
            <strong>selective authentication</strong>, and monitoring for cross-domain ticket requests.
        </p>

        <blockquote>
            The best defense against trust exploitation is the principle of least privilege ‚Äî only create
            trusts that are absolutely necessary and restrict them as much as possible.
        </blockquote>
    </div>

    <!-- POST NAV -->
    <div class="post-nav">
        <a href="/blog/">‚Üê All posts</a>
        <a href="/blog/posts/edr-bypass-techniques.html">Next post ‚Üí</a>
    </div>
</article>

<!-- FOOTER -->
<footer>
    <p>Designed by <span class="a">4mr</span> ¬∑ Red Team Operator ¬∑ Rabat, Morocco</p>
</footer>

</body>
</html>
